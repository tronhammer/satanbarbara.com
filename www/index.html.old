<!doctype html>
<html lang="en" ng-app="app">
<head>
	<meta charset="utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">

	<title>My Cal</title>	
	
	<link rel="stylesheet" href="lib/onsen/css/onsenui.css">	
	<link rel="stylesheet" href="styles/onsen-css-components.css">	
	<link rel="stylesheet" href="styles/app.css"/>

	<script src="lib/onsen/js/angular/angular.js"></script>	
	<script src="lib/onsen/js/onsenui.js"></script>	
	<script src="lib/bower_components/jquery/dist/jquery.min.js"></script>	
	<script src="lib/bower_components/tweenjs/build/tween.min.js"></script>	
	<script src="lib/bower_components/moment/min/moment.min.js"></script>	
	<script src="lib/bower_components/pikaday/pikaday.js"></script>	
	<script src="cordova.js"></script>	

	<script>
		(function(){
			window.SB = {
				"module": angular.module("app", ["onsen"]),
				"app": app
			};
		})();
	</script>
	<script src="js/sb.build.js"></script>	
	<script src="js/sb.app.js"></script>	
	<script>
	ons.ready(function() {

	});
	</script>
</head>

<body global-listener ng-controller="AppController">

	<ons-navigator>
	<ons-page ng-controller="CalendarController" style="{{styles.app}}" load-calendar-data>

		<div class="content">

		<header>
			<select name="monthDateSelector" month-update-listener>
			<option name="monthDate" value="8-1-2014">August</option>
			<option name="monthDate" value="9-3-2014">September</option>
			<option name="monthDate" value="10-1-2014" selected="selected">October</option>
			<option name="monthDate" value="11-1-2014">November</option>
			<option name="monthDate" value="12-1-2014">Decemeber</option>
			</select>
		</header>


		<ons-row>
			<ons-col width="{{profiles[ profile ].calendar.width}}" class="sb-calendar">
			<ons-row ng-repeat="week in month.weeks" class="sb-calendar-row" animate-calendar>
				<ons-col ng-repeat="day in week" class="sb-calendar-col" width="14%">
				<div class="sb-calendar-tile sb-highlight-container" data-date="{{day.date}}" ng-click="showDetail(day.date)" style="top: {{day.dist.x}}px; left: {{day.dist.y}}px; transform: scale({{day.dist.z}});">
					<div class="number">{{day.number}}</div>
					<div class="symbol">{{day.title}}</div>
					<div class="details">{{day.description}}</div>
					<ons-list class="sb-calendar-day-events">
					<ons-list-header>{{day.prettyDate}}</ons-list-header>
					<ons-list-item class="sb-calendar-event" ng-repeat="event in day.events">
						<div class="sb-calendar-event-title sb-calendar-event-info-item">{{event.get("title")}}</div>
						<div class="sb-calendar-event-acts sb-calendar-event-info-item">
							<header>Acts:</header>
							<span ng-repeat="band in event.bands">{{band.get("name")}}</span>
						</div>
						<div class="sb-calendar-event-description sb-calendar-event-info-item">
							<header>Description:</header>
							<p>{{event.get("description")}}</p>
						</div>
					</ons-list-item>
					</ons-list>
				</div>
				</ons-col>
			</ons-row>
			</ons-col>

			<ons-col class="sb-calendar-col" width="{{profiles[ profile ].infobox.width}}">
			<div class="sb-calendar-sidebar-day-events sb-highlight-container" animate-infobar>
				<div class="sb-calendar-sidebar-event-day">
				<ons-list class="sb-calendar-sidebar-day-event" ng-repeat="dayEvents in month.events">
					<ons-list-header>{{dayEvents.prettyDate}}</ons-list-header>
					<ons-list-item class="sb-calendar-sidebar-event" ng-repeat="event in dayEvents">
						<div class="sb-calendar-sidebar-event-title sb-calendar-event-info-item">{{event.get("title")}}</div>
						<div class="sb-calendar-sidebar-event-acts sb-calendar-event-info-item">
							<header>Acts:</header>
							<span ng-repeat="band in event.bands">{{band.get("name")}}</span>
						</div>
					</ons-list-item>
				</ons-list>
				</div>
			</div>

			<ons-button ng-click="createEvent.show()" class="sb-calendar-sidebar-create-event-btn">Create Event</ons-button>
			</ons-col>
		</ons-row>
		</div>
	</ons-page>
	</ons-navigator>

	<!-- MODALS -->

	<ons-modal var="createEvent" ng-controller="CreateEventController" create-event-listener>
    	<ons-icon icon="ion-loading-c" spin="true" style="display: none;"></ons-icon>

    	<sb-modal-exit></sb-modal-exit>

    	<div class="sb-modal-create-new-container">
            <ons-row>
                <ons-col width="100%" class="sb-modal-create-new-event-header">
                    <header>
                        <h1>Create New Event</h1>
                    </header>
                </ons-col>
            </ons-row>
            <ons-row>
                <ons-col width="100%">
                    <sb-field-string field="eventDefinitions['title']"></sb-field-string>
                </ons-col>
            </ons-row>
            <ons-row>
                <ons-col width="100%" class="sb-modal-create-new-event-primary-details">
                    <sb-field-string field="eventDefinitions['subtitle']"></sb-field-string>
                </ons-col>
            </ons-row>
            <ons-row>
                <ons-col width="30%" class="sb-modal-create-new-event-primary-details">
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="acts"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-date field="eventDefinitions['date']"></sb-field-date>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-time field="eventDefinitions['start_time']"></sb-field-time>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-time field="eventDefinitions['end_time']"></sb-field-time>
                        </ons-col>
                    </ons-row>
                </ons-col>
                <ons-col width="30%" class="sb-modal-create-new-event-date-details">
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="venueDefinitions['name']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="venueDefinitions['address']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="35%">
                            <sb-field-string field="venueDefinitions['city']"></sb-field-string>
                        </ons-col>
                        <ons-col width="20%">
                            <sb-field-string field="venueDefinitions['state']"></sb-field-string>
                        </ons-col>
                        <ons-col width="25%">
                            <sb-field-string field="venueDefinitions['zip']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-dropdown field="eventDefinitions['ages']"></sb-field-dropdown>
                        </ons-col>
                    </ons-row>
                </ons-col>
                <ons-col width="30%" class="sb-modal-create-new-event-venue-details">
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="eventDefinitions['flyer_uri']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="eventDefinitions['price']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="eventDefinitions['ticket_uri']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                    <ons-row>
                        <ons-col width="100%">
                            <sb-field-string field="eventDefinitions['promocode']"></sb-field-string>
                        </ons-col>
                    </ons-row>
                </ons-col>
            </ons-row>
            <ons-row>
                <ons-col width="100%">
                    <sb-field-text field="eventDefinitions['description']"></sb-field-text>
                </ons-col>
            </ons-row>
            <ons-row>
                <ons-col width="100%">
                    <sb-field-text field="eventDefinitions['requirements']"></sb-field-text>
                </ons-col>
            </ons-row>
            <ons-row>
                <ons-col width="100%">
                    <ons-button align="right" ng-click="hide()">Cancel</ons-button>
                    <ons-button align="right" ng-click="create()">Create</ons-button>
                </ons-col>
            </ons-row>
    	</div>
	</ons-modal>


	<!-- TEMPLATES -->
	<ons-template id="modalExit.tmpl">
    	<ons-icon icon="ion-arrow-shrink sb-modal-close"></ons-icon>
	</ons-template>

    <ons-template id="fieldString.tmpl">
        <ons-row data-id="{{field.name}}" data-type="{{field.type}}" class="sb-field-container sb-field-string" title="{{field.description}}">
            <ons-col width="100%" class="sb-field-label-container">
                <ons-field class="sb-field-label">{{field.label}}</ons-field>
            </ons-col>
            <ons-col width="100%" class="sb-field-input-container">
                <input name="{{field.name}}" placeholder="{{field.placeholder}}" width="300" data-validation="{{field.type}}" data-required="{{field.required}}" class="sb-field-input sb-field-string"/>
            </ons-col>
        </ons-row>
    </ons-template>

    <ons-template id="fieldText.tmpl">
        <ons-row data-id="{{field.name}}" data-type="{{field.type}}" class="sb-field-container sb-field-text" title="{{field.description}}">
            <ons-col width="100%" class="sb-field-label-container">
                <ons-field class="sb-field-label">{{field.label}}</ons-field>
            </ons-col>
            <ons-col width="100%" class="sb-field-input-container">
                <textarea name="{{field.name}}" placeholder="{{field.placeholder}}" data-validation="{{field.type}}" data-required="{{field.required}}" class="sb-field-input sb-field-text"></textarea>
            </ons-col>
        </ons-row>
    </ons-template>

    <ons-template id="fieldDropdown.tmpl">
        <ons-row data-id="{{field.name}}" data-type="{{field.type}}" class="sb-field-container sb-field-dropdown" title="{{field.description}}">
            <ons-col width="100%" class="sb-field-label-container">
                <ons-field class="sb-field-label">{{field.label}}</ons-field>
            </ons-col>
            <ons-col width="100%" class="sb-field-input-container">
                <select name="{{field.name}}" data-validation="{{field.type}}" data-required="{{field.required}}" class="sb-field-input sb-field-dropdown">
                    <option ng-repeat="option in field.options" value="{{option.name}}" selected="{{selected(option)}}">{{option.label}}</option>
                </select>
            </ons-col>
        </ons-row>
    </ons-template>

    <ons-template id="fieldDate.tmpl">
        <ons-row data-id="{{field.name}}" data-type="{{field.type}}" class="sb-field-container sb-field-date" title="{{field.description}}">
            <ons-col width="100%" class="sb-field-label-container">
                <ons-field class="sb-field-label">{{field.label}}</ons-field>
            </ons-col>
            <ons-col width="100%" class="sb-field-input-container">
                <input name="{{field.name}}" placeholder="{{today}}" width="300" data-validation="{{field.type}}" data-required="{{field.required}}" class="sb-field-input sb-field-date"/>
            </ons-col>
        </ons-row>
    </ons-template>

    <ons-template id="fieldTime.tmpl">
        <ons-row data-id="{{field.name}}" data-type="{{field.type}}" class="sb-field-container sb-field-time" title="{{field.description}}">
            <ons-col width="100%" class="sb-field-label-container">
                <ons-field class="sb-field-label">{{field.label}}</ons-field>
            </ons-col>
            <ons-col width="100%" class="sb-field-input-container">
                <input name="{{field.name}}" placeholder="{{now}}" width="300" data-validation="{{field.type}}" data-required="{{field.required}}" class="sb-field-input sb-field-time"/>
            </ons-col>
        </ons-row>
    </ons-template>
</body>	
</html>
